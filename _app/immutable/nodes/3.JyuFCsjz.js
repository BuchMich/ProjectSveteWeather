import{t as u,b as v}from"../chunks/BZYFzY8m.js";import{i as G}from"../chunks/JkvxYyOZ.js";import{p as J,j as n,k as i,l as c,o as y,v as S,w as Q,x as V,i as a,m as B,c as l}from"../chunks/YFQpMwCl.js";import{s as F,e as $}from"../chunks/DIySwqy1.js";import{p as D,i as w}from"../chunks/BLRbCggC.js";import{g as E,e as T,f as X,a as Y,b as ee,c as te,d as re,r as ae}from"../chunks/Dp3bwbva.js";import{s as oe}from"../chunks/DK-L4kDp.js";import{b as ie}from"../chunks/B_SJN6q_.js";var ne=u('<button class="text-red-500 hover:text-red-700 transition-colors" title="Aus Favoriten entfernen" aria-label="Aus Favoriten entfernen"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),se=u('<button class="text-gray-500 hover:text-yellow-500 transition-colors" title="Zu Favoriten hinzufügen" aria-label="Zu Favoriten hinzufügen"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></button>'),de=u('<div class="text-3xl"> </div>'),le=u('<div class="mt-2 text-gray-600"> </div>'),ve=u('<div class="p-4"><div class="flex items-center justify-between"><div class="text-3xl font-bold"> </div> <!></div> <!></div>'),ue=u('<div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow"><div class="flex justify-between items-center p-4 border-b"><h2 class="text-xl font-semibold"> </h2> <!></div> <!> <div class="p-4 bg-gray-50"><a class="block w-full text-center py-2 px-4 bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors">Details anzeigen</a></div></div>');function ce(N,f){J(f,!1);let r=D(f,"location",8),g=D(f,"onRemove",8),h=D(f,"isFavorite",8,!1),x=D(f,"onAddFavorite",8);function z(){g()(r())}function k(){x()(r())}G();var L=ue(),A=n(L),_=n(A),W=n(_);i(_);var j=c(_,2);{var P=o=>{var s=ne();$("click",s,z),v(o,s)},I=o=>{var s=se();$("click",s,k),v(o,s)};w(j,o=>{h()?o(P):o(I,!1)})}i(A);var M=c(A,2);{var R=o=>{var s=ve(),e=n(s),t=n(e),d=n(t);i(t);var m=c(t,2);{var Z=b=>{var p=de(),K=n(p,!0);i(p),y(U=>F(K,U),[()=>E(r().weather.weathercode,r().weather.temperature).icon],S),v(b,p)};w(m,b=>{r().weather.weathercode!==void 0&&b(Z)})}i(e);var q=c(e,2);{var H=b=>{var p=le(),K=n(p,!0);i(p),y(U=>F(K,U),[()=>E(r().weather.weathercode,r().weather.temperature).description],S),v(b,p)};w(q,b=>{r().weather.weathercode!==void 0&&b(H)})}i(s),y(()=>F(d,`${r().weather.temperature??""}${r().weather.units.temperature_2m??""}`)),v(o,s)};w(M,o=>{r().weather&&o(R)})}var C=c(M,2),O=n(C);i(C),i(L),y(o=>{F(W,`${r().name??""}, ${r().country??""}`),oe(O,"href",`${ie??""}/?city=${o??""}`)},[()=>encodeURIComponent(r().name)],S),v(N,L),Q()}var he=u('<div class="flex justify-center items-center p-12"><div class="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),fe=u('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"><p> </p></div>'),me=u('<div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4"><p>Keine Orte gefunden. Fügen Sie Orte zu Ihren Favoriten hinzu oder aktivieren Sie die Standortfreigabe.</p></div>'),be=u('<div class="container mx-auto p-4 max-w-4xl"><h1 class="text-3xl font-bold mb-6 text-center"> </h1> <!> <!> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div>');function Le(N,f){J(f,!1);let r=B([]),g=B(!1),h=B(null),x=B("favorites");async function z(e){try{const t=await te(e.latitude,e.longitude);return{...e,weather:{temperature:t.current.temperature_2m,weathercode:t.current.weathercode,units:t.current_units}}}catch(t){return console.error(`Fehler beim Laden der Wetterdaten für ${e.name}:`,t),e}}async function k(){l(g,!0),l(h,null);try{let e=[];if(X.subscribe(d=>{e=d})(),e.length>0){l(x,"favorites");const d=await Promise.all(e.map(m=>z(m)));l(r,d)}else{l(x,"nearby");const{latitude:d,longitude:m}=await Y(),Z=await ee(d,m,5),q=await Promise.all(Z.map(H=>z(H)));l(r,q)}}catch(e){l(h,e.message||"Fehler beim Laden der Orte"),console.error(a(h))}finally{l(g,!1)}}function L(e){ae(e),l(r,a(r).filter(t=>!(t.latitude===e.latitude&&t.longitude===e.longitude))),a(r).length===0&&k()}function A(e){re(e),l(r,a(r).map(t=>({...t,isFavorite:t.latitude===e.latitude&&t.longitude===e.longitude})))}V(()=>{k()});let _;V(()=>(_=setInterval(k,5*60*1e3),()=>clearInterval(_))),G();var W=be(),j=n(W),P=n(j,!0);i(j);var I=c(j,2);{var M=e=>{var t=he();v(e,t)};w(I,e=>{a(g)&&e(M)})}var R=c(I,2);{var C=e=>{var t=fe(),d=n(t),m=n(d,!0);i(d),i(t),y(()=>F(m,a(h))),v(e,t)};w(R,e=>{a(h)&&e(C)})}var O=c(R,2);{var o=e=>{var t=me();v(e,t)};w(O,e=>{a(r).length===0&&!a(g)&&!a(h)&&e(o)})}var s=c(O,2);T(s,5,()=>a(r),e=>e.latitude+e.longitude,(e,t)=>{const d=S(()=>a(x)==="favorites");ce(e,{get location(){return a(t)},onRemove:L,onAddFavorite:A,get isFavorite(){return a(d)}})}),i(s),i(W),y(()=>F(P,a(x)==="favorites"?"Meine Lieblingsorte":"Orte in meiner Nähe")),v(N,W),Q()}export{Le as component};
