import{c as ee,b as p,d as b,l as te,t as w}from"../chunks/CsrZeD0d.js";import{i as ae}from"../chunks/CvacVqCN.js";import{r as ie,aa as ne,ab as se,a2 as re,a7 as n,a8 as i,a9 as x,a4 as I,J as H,a5 as oe,ac as g,a6 as d,ad as Q,l as r,m as P,j as m}from"../chunks/CQPBOp8T.js";import{s as z,e as T}from"../chunks/C9MGWePa.js";import{p as Z,i as j}from"../chunks/CQlZXS1c.js";import{g as X,e as le,f as de,a as ve,b as ce,l as Y,c as ue,d as he,r as fe}from"../chunks/D5oZlteV.js";import{s as me}from"../chunks/BbbBA12y.js";import{b as ge}from"../chunks/DmiHIoa6.js";function be(S,_){ie(()=>{const t=new Map,v=S(),c=ne(v)?v:v==null?[]:Array.from(v),F=c.length;for(let u=0;u<F;u++){const h=_(c[u],u);if(t.has(h)){const k=String(t.get(h)),L=String(u);let f=String(h);f.startsWith("[object ")&&(f=null),se(k,L,f)}t.set(h,u)}})}y[d]="src/lib/components/FavoriteLocation.svelte";var pe=p(w('<button class="text-red-500 hover:text-red-700 transition-colors" title="Aus Favoriten entfernen" aria-label="Aus Favoriten entfernen"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),y[d],[[25,6,[[31,8,[[32,10]]]]]]),we=p(w('<button class="text-gray-500 hover:text-yellow-500 transition-colors" title="Zu Favoriten hinzufügen" aria-label="Zu Favoriten hinzufügen"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></button>'),y[d],[[36,6,[[42,8,[[43,10]]]]]]),_e=p(w('<div class="text-3xl"> </div>'),y[d],[[58,10]]),xe=p(w('<div class="mt-2 text-gray-600"> </div>'),y[d],[[65,8]]),ye=p(w('<div class="p-4"><div class="flex items-center justify-between"><div class="text-3xl font-bold"> </div> <!></div> <!></div>'),y[d],[[51,4,[[52,6,[[53,8]]]]]]),Fe=p(w('<div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow"><div class="flex justify-between items-center p-4 border-b"><h2 class="text-xl font-semibold"> </h2> <!></div> <!> <div class="p-4 bg-gray-50"><a class="block w-full text-center py-2 px-4 bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors">Details anzeigen</a></div></div>'),y[d],[[19,0,[[21,2,[[22,4]]],[73,2,[[74,4]]]]]]);function y(S,_){ee(new.target),re(_,!1,y);let t=Z(_,"location",8),v=Z(_,"onRemove",8),c=Z(_,"isFavorite",8,!1),F=Z(_,"onAddFavorite",8);function u(){v()(t())}function h(){F()(t())}ae();var k=Fe(),L=n(k),f=n(L),C=n(f);i(f);var O=x(f,2);{var J=o=>{var s=pe();T("click",s,u),b(o,s)},B=o=>{var s=we();T("click",s,h),b(o,s)};j(O,o=>{c()?o(J):o(B,!1)})}i(L);var D=x(L,2);{var N=o=>{var s=ye(),e=n(s),a=n(e),l=n(a);i(a);var A=x(a,2);{var K=W=>{var M=_e(),$=n(M,!0);i(M),I(G=>z($,G),[()=>X(t().weather.weathercode,t().weather.temperature).icon],H),b(W,M)};j(A,W=>{g(t().weather.weathercode,void 0,!1)&&W(K)})}i(e);var U=x(e,2);{var V=W=>{var M=xe(),$=n(M,!0);i(M),I(G=>z($,G),[()=>X(t().weather.weathercode,t().weather.temperature).description],H),b(W,M)};j(U,W=>{g(t().weather.weathercode,void 0,!1)&&W(V)})}i(s),I(()=>z(l,`${t().weather.temperature??""}${t().weather.units.temperature_2m??""}`)),b(o,s)};j(D,o=>{t().weather&&o(N)})}var q=x(D,2),E=n(q);return i(q),i(k),I(o=>{z(C,`${t().name??""}, ${t().country??""}`),me(E,"href",`${ge??""}/?city=${o??""}`)},[()=>encodeURIComponent(t().name)],H),b(S,k),oe({...te()})}R[d]="src/routes/favorites/+page.svelte";var ke=p(w('<div class="flex justify-center items-center p-12"><div class="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>'),R[d],[[107,4,[[108,6]]]]),Le=p(w('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"><p> </p></div>'),R[d],[[113,4,[[114,6]]]]),Ae=p(w('<div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4"><p>Keine Orte gefunden. Fügen Sie Orte zu Ihren Favoriten hinzu oder aktivieren Sie die Standortfreigabe.</p></div>'),R[d],[[119,4,[[120,6]]]]),We=p(w('<div class="container mx-auto p-4 max-w-4xl"><h1 class="text-3xl font-bold mb-6 text-center"> </h1> <!> <!> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div></div>'),R[d],[[101,0,[[102,2],[125,2]]]]);function R(S,_){ee(new.target),re(_,!1,R);let t=P([]),v=P(!1),c=P(null),F=P("favorites");async function u(e){try{const a=await ue(e.latitude,e.longitude);return{...e,weather:{temperature:a.current.temperature_2m,weathercode:a.current.weathercode,units:a.current_units}}}catch(a){return console.error(...Y("error",`Fehler beim Laden der Wetterdaten für ${e.name}:`,a)),e}}async function h(){m(v,!0),m(c,null);try{let e=[];if(de.subscribe(l=>{e=l})(),e.length>0){m(F,"favorites");const l=await Promise.all(e.map(A=>u(A)));m(t,l)}else{m(F,"nearby");const{latitude:l,longitude:A}=await ve(),K=await ce(l,A,5),U=await Promise.all(K.map(V=>u(V)));m(t,U)}}catch(e){m(c,e.message||"Fehler beim Laden der Orte"),console.error(...Y("error",r(c)))}finally{m(v,!1)}}function k(e){fe(e),m(t,r(t).filter(a=>!(g(a.latitude,e.latitude)&&g(a.longitude,e.longitude)))),g(r(t).length,0)&&h()}function L(e){he(e),m(t,r(t).map(a=>({...a,isFavorite:g(a.latitude,e.latitude)&&g(a.longitude,e.longitude)})))}Q(()=>{h()});let f;Q(()=>(f=setInterval(h,5*60*1e3),()=>clearInterval(f))),ae();var C=We(),O=n(C),J=n(O,!0);i(O);var B=x(O,2);{var D=e=>{var a=ke();b(e,a)};j(B,e=>{r(v)&&e(D)})}var N=x(B,2);{var q=e=>{var a=Le(),l=n(a),A=n(l,!0);i(l),i(a),I(()=>z(A,r(c))),b(e,a)};j(N,e=>{r(c)&&e(q)})}var E=x(N,2);{var o=e=>{var a=Ae();b(e,a)};j(E,e=>{g(r(t).length,0)&&!r(v)&&!r(c)&&e(o)})}var s=x(E,2);return be(()=>r(t),e=>e.latitude+e.longitude),le(s,5,()=>r(t),e=>e.latitude+e.longitude,(e,a)=>{const l=H(()=>g(r(F),"favorites"));y(e,{get location(){return r(a)},onRemove:k,onAddFavorite:L,get isFavorite(){return r(l)}})}),i(s),i(C),I(()=>z(J,g(r(F),"favorites")?"Meine Lieblingsorte":"Orte in meiner Nähe")),b(S,C),oe({...te()})}export{R as component};
